<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>å­¦æœ¯èŸ‘è‚æŠ½å¡æœº</title>
  <style>
    body {
      font-family: 'Courier New', monospace;
      background: #111;
      color: #fff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
    }
    h1 {
      font-size: 2.2rem;
      color: #facc15;
      margin-bottom: 1rem;
    }
    button {
      padding: 1rem 2rem;
      background: #facc15;
      border: none;
      border-radius: 8px;
      color: #111;
      font-size: 1.2rem;
      cursor: pointer;
    }
    #card {
      margin-top: 2rem;
      font-size: 1.3rem;
      text-align: center;
      padding: 2rem;
      border: 2px dashed #facc15;
      border-radius: 12px;
      max-width: 500px;
      opacity: 0;
      transform: scale(0.8);
      transition: opacity 0.4s ease, transform 0.4s ease;
    }
    #card.show {
      opacity: 1;
      transform: scale(1);
    }
    .card-title {
      font-weight: bold;
      color: #facc15;
      margin-bottom: 0.5rem;
      font-size: 1.4rem;
    }
    .card-body {
      font-size: 1.2rem;
      line-height: 1.5;
    }
    #history {
      margin-top: 2rem;
      width: 90%;
      max-width: 500px;
      text-align: left;
    }
    #history h2 {
      color: #facc15;
      font-size: 1.3rem;
      margin-bottom: 0.5rem;
    }
    #history-list {
      list-style: none;
      padding: 0;
      max-height: 200px;
      overflow-y: auto;
    }
    #history-list li {
      background: rgba(250, 201, 21, 0.1);
      margin-bottom: 0.5rem;
      padding: 0.5rem;
      border-radius: 4px;
      font-size: 0.95rem;
    }
  </style>
</head>
<body>
  <h1>ç§‘ç ”èŸ‘è‚æŠ½å¡æœº ğŸ´</h1>
  <button id="draw-btn">æŠ½ä¸€å¼ å¡ï¼</button>
  <div id="card"></div>
  <div id="history">
    <h2>æŠ½å¡è®°å½•</h2>
    <ul id="history-list"></ul>
  </div>
  <audio id="bgm" loop style="display:none;">
    <source src="https://cdn.pixabay.com/audio/2022/10/16/audio_12f81b54f6.mp3" type="audio/mp3">
  </audio>
  <script>
    // ----------------å¡æ± å†…å®¹-----------------
    const cards = [
        { level: 'R', text: "æ•´ç†3æ¡ä»Šå¤©çš„å¾…åŠäº‹é¡¹ã€‚" },
        { level: 'R', text: "éšæœºè¯»ä¸€ç¯‡ç›¸å…³é¢†åŸŸçš„æ–‡çŒ®æ‘˜è¦ï¼Œå¹¶ç”¨ä¸€å¥è¯æ€»ç»“å®ƒçš„ä¸»è¦è§‚ç‚¹ã€‚" },
        { level: 'R', text: "æŠŠæ¡Œé¢æ•´ç†10åˆ†é’Ÿï¼Œåªæ”¶æ‹¾å’Œç§‘ç ”ç›¸å…³çš„ä¸œè¥¿ã€‚" },
        { level: 'R', text: "èŠ±15åˆ†é’Ÿåœ¨æ•°æ®åº“ï¼ˆå¦‚PubMed/Google Scholarï¼‰éšæœºæœè¯¾é¢˜çƒ­è¯ï¼Œå¹¶é˜…è¯»1ç¯‡æ–°æ–‡çŒ®ã€‚" },
        { level: 'R', text: "å’ŒGPTèŠ5åˆ†é’Ÿï¼šä»Šå¤©ä½ æœ€æƒ³è§£å†³çš„researchå°é—®é¢˜æ˜¯ä»€ä¹ˆï¼Ÿ" },
        { level: 'R', text: "çœ‹ä¸€ä½é¢†åŸŸå¤§ç‰›çš„æ–°è®ºæ–‡/è®²åº§è§†é¢‘ã€‚" },
        { level: 'R', text: "æ‰¾ä¸€ç¯‡ä½ å¯¼å¸ˆè¿‘3å¹´å†…çš„è®ºæ–‡ï¼ŒæŠŠæ‘˜è¦æŠ„ä¸€éã€‚" },
        { level: 'R', text: "æ‰“å¼€è€æ–‡çŒ®ï¼Œæ ‡è®°å‡º1å¥ä½ è§‰å¾—æœ€æœ‰ç”¨æˆ–æœ€æƒ³åæ§½çš„è¯ã€‚" },
        { level: 'R', text: "èŠ±10åˆ†é’Ÿæ£€æŸ¥é‚®ç®±ï¼ŒæŠŠå…¨éƒ¨å’Œç ”ç©¶ç›¸å…³çš„é‚®ä»¶å½’æ¡£åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ã€‚" },
        { level: 'R', text: "æ‰¾ä¸€ä¸ªä½ ä»æ²¡è¯•è¿‡çš„æ•°æ®åº“ï¼Œæ£€ç´¢è¯¾é¢˜ç›¸å…³å…³é”®è¯å¹¶æˆªå›¾ç•Œé¢ã€‚" },
        { level: 'R', text: "å¿…é¡»å†™è‡³å°‘500 wordsç§‘ç ”ç›¸å…³è¾“å‡ºï¼Œå†™å®Œæ‰èƒ½ä¼‘æ¯ã€‚" },
        { level: 'R', text: "å½•ä¸€æ®µä½ å‘è‡ªå·±è§£é‡Šç ”ç©¶æ–¹æ³•çš„è§†é¢‘ï¼Œå­˜æ¡£ä»¥åçœ‹ç¬‘è¯" },
        { level: 'R', text: "ç”¨1åˆ†é’Ÿè¯´å‡ºä½ é¡¹ç›®çš„ç ”ç©¶é—®é¢˜ï¼Œæ‰‹æœºå½•éŸ³å›æ”¾ä¸€æ¬¡ã€‚" },
        { level: 'R', text: "ç»™è‡ªå·±å®‰æ’ä¸€æ¬¡10åˆ†é’Ÿçš„å†¥æƒ³ï¼Œæƒ³è±¡ç§‘ç ”é¡ºåˆ©çš„ä¸€å¤©ã€‚" },
        { level: 'R', text: "ç”¨ä¸€å¥è¯ä¸ºä½ çš„è®ºæ–‡æˆ–é¡¹ç›®å†™ä¸€ä¸ªå¸å¼•äººçš„æ ‡é¢˜ï¼Œå†™ä¸‰ç‰ˆã€‚" },
        { level: 'R', text: "éšæœºæŸ¥æ‰¾è€å¹´æ‚£è€…ä½é™¢è´¨é‡ç›¸å…³çš„ä¸€ä¸ªè¯„ä¼°é‡è¡¨ï¼Œæ•´ç†åˆ°è‡ªå·±çš„çŸ¥è¯†åº“" },
        { level: 'R', text: "ç»Ÿè®¡ä½ ç ”ç©¶å¯¹è±¡ä¸­è€å¹´ä½é™¢ç‡çš„æœ€æ–°æ–‡çŒ®æ•°æ®ï¼Œå¹¶å†™ä¸€å¥æ€»ç»“ã€‚" },
        { level: 'R', text: "ç”¨è¡¨æ ¼å¯¹æ¯”ä¸¤ç§å¸¸è§è€å¹´ç–¾ç—…ï¼ˆå¦‚ç³–å°¿ç—…å’Œé«˜è¡€å‹ï¼‰çš„ä½é™¢æ²»ç–—æµç¨‹ã€‚" },
        { level: 'R', text: "å®šæ—¶45åˆ†é’Ÿç•ªèŒ„é’Ÿï¼Œä¸çœ‹æ‰‹æœºï¼Œä¸“æ³¨å†™ä½œ/é˜…è¯»ä¸€é¡¹ç ”ç©¶ä»»åŠ¡ã€‚" },
        { level: 'R', text: "èµ·èº«å–æ°´800mlï¼Œå˜èº«ç§‘ç ”æ°´æ¯ğŸª¼" },
        { level: 'R', text: "éšæœºæŸ¥ä¸€ä¸ªä½ ä¸äº†è§£çš„å®—æ•™ï¼Œäº†è§£15åˆ†é’Ÿ" },
        { level: 'SR', text: "è®¾å®šä¸¤å°æ—¶å†™ä½œæ— ç½‘æŒ‘æˆ˜ï¼ŒæˆåŠŸå¯åˆ·30åˆ†é’ŸæŠ–éŸ³" },
        { level: 'SR', text: "æ ¹æ®æ¾³å¤§åˆ©äºšå«ç”Ÿéƒ¨é—¨æ•°æ®ï¼Œå†™ä¸€æ®µå½“å‰è€å¹´äººä½é™¢ä¸»è¦åŸå› çš„åˆ†æï¼ˆ100å­—+ï¼‰ã€‚" },
        { level: 'SR', text: "å½’çº³å¹¶ç”»å‡º1å¼ å›¾ç¤ºï¼Œå±•ç¤ºè€å¹´äººå¸¸è§æ…¢ç—…çš„æ‚£ç—…ç‡éšå¹´é¾„çš„å˜åŒ–è¶‹åŠ¿ã€‚" },
        { level: 'SR', text: "å†™ä¸€ä»½ç®€è¦æŠ¥å‘Šï¼Œæ¯”è¾ƒä¸åŒå›½å®¶è€å¹´æ‚£è€…å¹³å‡ä½é™¢å¤©æ•°çš„å·®å¼‚åŠå¯èƒ½åŸå› ã€‚" },
        { level: 'SR', text: "æŒ‘ä¸€ä¸ªç†è®ºæ¦‚å¿µï¼ŒæŸ¥æ‰¾2-3æ¡ä¸åŒå­¦è€…çš„è§‚ç‚¹ï¼Œå†™å°æ€»ç»“ã€‚" },
        { level: 'SR', text: "å†™ä¸€ç¯‡ã€Šç§‘ç ”æ‹‰è¸©æ–‡ã€‹ï¼Œå†…å®¹ä¸é™å¯¹è±¡ï¼Œè¶Šdramaè¶Šå¥½" },
        { level: 'SR', text: "ç²¾è¯»ä¸€ç¯‡æ–‡çŒ®çš„methodséƒ¨åˆ†ï¼Œç”¨è‡ªå·±çš„è¯å¤è¿°æµç¨‹è¦ç‚¹å¹¶è½¬å½•ä¸‹æ¥ã€‚" },
        { level: 'SR', text: "è®©GPTå†™ä¸€ä»½â€˜ç§‘ç ”ç–¯äººç”³è¯·è¡¨â€™ï¼Œå†…å®¹è¶Šç¦»è°±è¶Šå¥½" },
        { level: 'SR', text: "è®¾ç½®ç•ªèŒ„é’Ÿ45åˆ†é’Ÿå†™ä½œï¼Œç«‹åˆ»å¼€å§‹" },
        { level: 'SR', text: "å’ŒGPTå¯¹è¯30åˆ†é’Ÿï¼ŒåªèŠè‡ªå·±çš„å­¦æœ¯é¢†åŸŸ" },
        { level: 'SR', text: "ä¸ºä½ çš„ç ”ç©¶å†™ä¸€ä¸ªâ€œFAQâ€ï¼ˆå¸¸è§ç–‘æƒ‘3æ¡åŠä½ çš„å›å¤ï¼‰ã€‚" },
        { level: 'SR', text: "æŸ¥æ‰¾å¹¶å½’çº³ä¸€ä¸ªç›¸å…³é¢†åŸŸçš„æŠ€æœ¯æ–°æ–¹æ³•ï¼Œå¹¶å†™æˆ1é¡µpptæˆ–ä¸€æ®µæ€»ç»“ã€‚" },
        { level: 'SR', text: "å†™ä¸€å¥sloganï¼Œåšæˆè¡¨æƒ…åŒ…ï¼ˆå¯AIç”Ÿæˆ/æ‰‹ç»˜ï¼‰ï¼Œè¡¨è¾¾ä½ ç ”ç©¶æ ¸å¿ƒã€‚" },
        { level: 'SR', text: "å†™ä¸€ä»½æ–‡çŒ®é˜…è¯»ç¬”è®°ï¼Œæ€»ç»“ä¸€ç¯‡è®ºæ–‡çš„åˆ›æ–°ä¹‹å¤„å’Œä¸è¶³ã€‚" },
        { level: 'SR', text: "æ€»ç»“3æ¡æ¾³å¤§åˆ©äºšè€å¹´åŒ»å­¦ç›¸å…³å¥åº·æ”¿ç­–ï¼Œå†™è¿›ç ”ç©¶ç¬”è®°ã€‚" },
        { level: 'SSR', text: "å…³æ‰æ‰€æœ‰æ¶ˆæ¯é€šçŸ¥5å°æ—¶ï¼Œä¸–ç•Œå¡Œäº†ä¹Ÿä¸è®¸å¼€" },
        { level: 'SSR', text: "ç”¨ç•ªèŒ„å·¥ä½œæ³•å®Œæˆ3*45åˆ†é’Ÿè¿ç»­é«˜æ•ˆç ”ç©¶è¾“å‡ºï¼Œæ¯è½®åå†™ä¸€å¥å¿ƒå¾—ä½“ä¼šã€‚" },
        { level: 'SSR', text: "è¿ç»­å†™ä½œ90åˆ†é’Ÿï¼Œå®Œæˆä¸€ä»½äº§å‡ºå°èŠ‚åˆç¨¿ï¼ˆä¸å°‘äº400å­—ï¼‰ã€‚" },
        { level: 'SSR', text: "å†™ä¸€é¡µç¬”è®°ï¼Œè®¨è®ºè€å¹´åŒ»å­¦é¢†åŸŸç›®å‰æœ€å¤§æœªæ»¡è¶³å¥åº·éœ€æ±‚ï¼ˆunmet needsï¼‰ã€‚" },
        { level: 'SSR', text: "æŒ‘é€‰ä¸€ä»½é«˜å½±å“åŠ›çš„è€å¹´åŒ»å­¦æŒ‡å—/æ”¿ç­–ï¼Œå†™ä¸€æ®µæ‘˜è¦è¯´æ˜å…¶å¯¹ä½ è¯¾é¢˜çš„æ„ä¹‰ã€‚" },
        { level: 'SSR', text: "æœä¸€ä¸ªâ€œå¦‚ä½•èººå¹³å´ä»ç„¶èµ¢å¾—è¯ºå¥–â€çš„å…³é”®è¯ï¼Œè¯»å®ƒ" },
        { level: 'SSR', text: "æ•´ç†å‡ºä½ è¯¾é¢˜æ ¸å¿ƒé¢†åŸŸè¿‘äº”å¹´10ç¯‡ä»£è¡¨æ€§æ–‡çŒ®ï¼Œåšå…³é”®è¯ã€æ–¹æ³•ã€ç»“è®ºä¸‰æ å¯¹æ¯”è¡¨ã€‚" },
        { level: 'SSR', text: "å†™ä¸€ç¯‡500 wordsäº§å‡ºè‰ç¨¿" },
    ];
    // --------åˆ†çº§æŠ½å–æ¦‚ç‡-------------
    const rCards   = cards.filter(c => c.level === 'R');
    const srCards  = cards.filter(c => c.level === 'SR');
    const ssrCards = cards.filter(c => c.level === 'SSR');

    // --------æŠ½å¡è®°å½•éƒ¨åˆ†-------------
    let history = JSON.parse(localStorage.getItem('drawCardHistory') || '[]');
    function renderHistory() {
      historyList.innerHTML = history.map(i => `<li>${i}</li>`).join('');
    }
    renderHistory();

    // ----------æŠ½å¡æœºåˆ¶å‚æ•°------------
    const DRAW_LIMIT = 2;     // æ¯5å°æ—¶å¯æŠ½2æ¬¡
    const COOLDOWN = 5 * 60 * 60 * 1000; // 5å°æ—¶ï¼Œæ¯«ç§’

    function getDrawState() {
      const state = JSON.parse(localStorage.getItem('drawCardCycleState') || '{}');
      return state;
    }

    function setDrawState(state) {
      localStorage.setItem('drawCardCycleState', JSON.stringify(state));
    }

    function getCurrentCycle() {
      // ç”¨2024-01-01 00:00ä¸ºæ—¶é—´åŸç‚¹
      const epoch = new Date('2024-01-01T00:00:00').getTime();
      const now = Date.now();
      const diff = now - epoch;
      const cycle = Math.floor(diff / COOLDOWN);
      return cycle;
    }

    function updateDrawBtn() {
      const cycle = getCurrentCycle();
      const state = getDrawState();
      const cur = state[cycle] || { count: 0, time: Date.now() };
      if (cur.count >= DRAW_LIMIT) {
        // è®¡ç®—ä¸‹ä¸€ä¸ªåˆ·æ–°æ—¶é—´
        const nextCycle = (cycle + 1) * COOLDOWN + new Date('2024-01-01T00:00:00').getTime();
        const leftMs = nextCycle - Date.now();
        const leftH = Math.ceil(leftMs / 3600000);
        drawBtn.disabled = true;
        drawBtn.textContent = `å·²æŠ½${DRAW_LIMIT}æ¬¡ï¼Œ${leftH}å°æ—¶ååˆ·æ–°ğŸ´`;
      } else {
        drawBtn.disabled = false;
        drawBtn.textContent = `æŠ½ä¸€å¼ å¡ï¼ï¼ˆæœ¬è½®å‰©ä½™${DRAW_LIMIT - cur.count}æ¬¡ï¼‰`;
      }
    }

    function drawCard() {
      const cycle = getCurrentCycle();
      const state = getDrawState();
      if (!state[cycle]) state[cycle] = { count: 0, time: Date.now() };
      if (state[cycle].count >= DRAW_LIMIT) {
        alert("æœ¬è½®å·²ç”¨å®Œ2æ¬¡æŠ½å¡æœºä¼šï¼Œè¯·ç­‰å¾…5å°æ—¶åˆ·æ–°ï¼");
        updateDrawBtn();
        return;
      }
      if (bgm.paused) bgm.play().catch(() => {});
      const rand = Math.random();
      let pool = rand < 0.15 ? ssrCards : rand < 0.40 ? srCards : rCards;
      const card = pool[Math.floor(Math.random() * pool.length)];
      cardDiv.classList.remove('show');
      cardDiv.innerHTML = `<div class='card-title'>${card.level} æŠ½ä¸­ï¼</div><div class='card-body'>${card.text}</div>`;
      setTimeout(() => cardDiv.classList.add('show'), 50);
      const timestamp = new Date().toLocaleString();
      history.unshift(`${timestamp} â€” ${card.level} - ${card.text}`);
      if (history.length > 20) history.pop();
      localStorage.setItem('drawCardHistory', JSON.stringify(history));
      renderHistory();

      state[cycle].count += 1;
      setDrawState(state);

      updateDrawBtn();
    }

    // è‡ªåŠ¨æ£€æµ‹æ–°å‘¨æœŸåˆ°æ¥ï¼Œåˆ·æ–°æŒ‰é’®
    setInterval(updateDrawBtn, 5000); // æ¯5ç§’æ£€æµ‹ä¸€æ¬¡
    updateDrawBtn();

    drawBtn.onclick = drawCard;
  </script>
</body>
</html>
